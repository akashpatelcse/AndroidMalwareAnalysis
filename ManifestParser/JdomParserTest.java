package ManifestParser;

import ManifestParser.util.utilities;
import org.jdom2.Attribute;
import org.jdom2.Document;
import org.jdom2.Element;
import org.jdom2.JDOMException;
import org.jdom2.input.SAXBuilder;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.List;

public class JdomParserTest {


    public static void main(String[] args){
        String apkPath = "/home/akash/Dataset/D2/goodware/00cc964cd4dbe689f868869e8cfd938f21cd05930b4c05012e65c1303b50d992.apk";
        String manifest = utilities.getManifest(apkPath);
        System.out.println(manifest);
        System.out.println("------------------------------");
        List<String> s = getActivity(manifest);
    }

    static List<String> getActivity(String manifest){
        SAXBuilder sax = new SAXBuilder();
        InputStream targetStream = new ByteArrayInputStream(manifest.getBytes());
        Document doc = null;
        try {
            doc = sax.build(targetStream);
        } catch (Exception ignored) {}
        Element rootNode = doc.getRootElement();
        List<Element> nodes = rootNode.getChildren("application");

        for(Element i : nodes){
            List<Element> node = i.getChildren("activity");
            for(Element ele : node){
                for(Attribute attri : ele.getAttributes()){
                    if(attri.getName().equals("name")) {
                        String key = attri.getValue();
                        System.out.println(key);
                    }
                }
            }
        }
        return null;
    }
}
