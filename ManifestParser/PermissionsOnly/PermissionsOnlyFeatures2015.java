package ManifestParser.PermissionsOnly;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.Map;
import java.util.TreeMap;

public class PermissionsOnlyFeatures2015 {
    String filePath = "/home/akash/Documents/CsvFiles/ALLPermissionsOnlyDataset2015-2017.csv";
    private TreeMap<String, Integer> hm = new TreeMap<String, Integer>() {{
        put( "ANDROID.PERMISSION.RECORD_VIDEO", 0 );
        put( "ANDROID.PERMISSION.REORDER_TASKS", 0 );
        put( "ANDROID.PERMISSION.ACCESS_DOWNLOAD_MANAGER", 0 );
        put( "ANDROID.PERMISSION.SET_ORIENTATION", 0 );
        put( "ANDROID.PERMISSION.READ_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.GLOBAL_SEARCH_CONTROL", 0 );
        put( "ANDROID.WEBKIT.PERMISSION.PLUGIN", 0 );
        put( "ANDROID.PERMISSION.STATUS_BAR", 0 );
        put( "ANDROID.PERMISSION.CALL_PRIVILEGED", 0 );
        put( "ANDROID.PERMISSION.SET_PREFERRED_APPLICATIONS", 0 );
        put( "ANDROID.PERMISSION.WRITE_OWNER_DATA", 0 );
        put( "ANDROID.PERMISSION.READ_OWNER_DATA", 0 );
        put( "ANDROID.PERMISSION.CHANGE_COMPONENT_ENABLED_STATE", 0 );
        put( "ANDROID.PERMISSION.MANAGE_ACCOUNTS", 0 );
        put( "ANDROID.PERMISSION.BATTERY_STATS", 0 );
        put( "ANDROID.PERMISSION.USE_CREDENTIALS", 0 );
        put( "ANDROID.PERMISSION.CONTROL_LOCATION_UPDATES", 0 );
        put( "ANDROID.PERMISSION.READ_SYNC_SETTINGS", 0 );
        put( "COM.ANDROID.LAUNCHER.PERMISSION.WRITE_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.WRITE_SYNC_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.SET_WALLPAPER_HINTS", 0 );
        put( "ANDROID.PERMISSION.CLEAR_APP_CACHE", 0 );
        put( "COM.ANDROID.VENDING.CHECK_LICENSE", 0 );
        put( "ANDROID.PERMISSION.ACCESS_CACHE_FILESYSTEM", 0 );
        put( "ANDROID.PERMISSION.EXPAND_STATUS_BAR", 0 );
        put( "ANDROID.PERMISSION.GET_PACKAGE_SIZE", 0 );
        put( "ANDROID.PERMISSION.DELETE_CACHE_FILES", 0 );
        put( "ANDROID.PERMISSION.ACCESS_LOCATION", 0 );
        put( "ANDROID.PERMISSION.DEVICE_POWER", 0 );
        put( "ANDROID.PERMISSION.READ_CALENDAR", 0 );
        put( "ANDROID.PERMISSION.WRITE_CALENDAR", 0 );
        put( "ANDROID.PERMISSION.BROADCAST_STICKY", 0 );
        put( "ANDROID.PERMISSION.ACCESS_GPS", 0 );
        put( "ANDROID.PERMISSION.UPDATE_DEVICE_STATS", 0 );
        put( "ANDROID.PERMISSION.ACCESS_COARSE_UPDATES", 0 );
        put( "ANDROID.PERMISSION.ACCESS_MOCK_LOCATION", 0 );
        put( "ANDROID.PERMISSION.MODIFY_PHONE_STATE", 0 );
        put( "COM.ANDROID.ALARM.PERMISSION.SET_ALARM", 0 );
        put( "ANDROID.PERMISSION.RECEIVE_MMS", 0 );
        put( "ANDROID.PERMISSION.RECEIVE_WAP_PUSH", 0 );
        put( "ANDROID.PERMISSION.FLASHLIGHT", 0 );
        put( "ANDROID.PERMISSION.KILL_BACKGROUND_PROCESSES", 0 );
        put( "COM.SOFTWARE.APPLICATION.PERMISSION.C2D_MESSAGE", 0 );
        put( "ANDROID.PERMISSION.MODIFY_AUDIO_SETTINGS", 0 );
        put( "COM.ANDROID.VENDING.BILLING", 0 );
        put( "ANDROID.PERMISSION.BLUETOOTH_ADMIN", 0 );
        put( "ANDROID.PERMISSION.DELETE_PACKAGES", 0 );
        put( "ANDROID.PERMISSION.WRITE_SECURE_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.CHANGE_CONFIGURATION", 0 );
        put( "ANDROID.PERMISSION.BLUETOOTH", 0 );
        put( "ANDROID.PERMISSION.PROCESS_OUTGOING_CALLS", 0 );
        put( "ANDROID.PERMISSION.SYSTEM_ALERT_WINDOW", 0 );
        put( "ANDROID.PERMISSION.READ_EXTERNAL_STORAGE", 0 );
        put( "ORG.ADW.LAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.RECORD_AUDIO", 0 );
        put( "COM.FEDE.LAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "COM.MOTOROLA.DLAUNCHER.PERMISSION.INSTALL_SHORTCUT", 0 );
        put( "COM.LGE.LAUNCHER.PERMISSION.INSTALL_SHORTCUT", 0 );
        put( "COM.MOTOROLA.LAUNCHER.PERMISSION.INSTALL_SHORTCUT", 0 );
        put( "ANDROID.PERMISSION.CHANGE_NETWORK_STATE", 0 );
        put( "COM.MOTOROLA.DLAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "COM.MOTOROLA.LAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "COM.LGE.LAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "COM.HTC.LAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.DISABLE_KEYGUARD", 0 );
        put( "ANDROID.PERMISSION.WRITE_APN_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.MOUNT_UNMOUNT_FILESYSTEMS", 0 );
        put( "COM.ANDROID.LAUNCHER.PERMISSION.READ_SETTINGS", 0 );
        put( "COM.GOOGLE.ANDROID.C2DM.PERMISSION.RECEIVE", 0 );
        put( "ANDROID.PERMISSION.ACCESS_LOCATION_EXTRA_COMMANDS", 0 );
        put( "ANDROID.PERMISSION.GET_ACCOUNTS", 0 );
        put( "ANDROID.PERMISSION.WRITE_CONTACTS", 0 );
        put( "ANDROID.PERMISSION.SET_WALLPAPER", 0 );
        put( "ANDROID.PERMISSION.READ_LOGS", 0 );
        put( "COM.ANDROID.LAUNCHER.PERMISSION.UNINSTALL_SHORTCUT", 0 );
        put( "ANDROID.PERMISSION.INSTALL_PACKAGES", 0 );
        put( "COM.ANDROID.BROWSER.PERMISSION.WRITE_HISTORY_BOOKMARKS", 0 );
        put( "ANDROID.PERMISSION.CAMERA", 0 );
        put( "COM.ANDROID.BROWSER.PERMISSION.READ_HISTORY_BOOKMARKS", 0 );
        put( "ANDROID.PERMISSION.RESTART_PACKAGES", 0 );
        put( "ANDROID.PERMISSION.WRITE_SETTINGS", 0 );
        put( "ANDROID.PERMISSION.GET_TASKS", 0 );
        put( "ANDROID.PERMISSION.WRITE_SMS", 0 );
        put( "ANDROID.PERMISSION.CALL_PHONE", 0 );
        put( "ANDROID.PERMISSION.CHANGE_WIFI_STATE", 0 );
        put( "COM.ANDROID.LAUNCHER.PERMISSION.INSTALL_SHORTCUT", 0 );
        put( "ANDROID.PERMISSION.READ_CONTACTS", 0 );
        put( "ANDROID.PERMISSION.READ_SMS", 0 );
        put( "ANDROID.PERMISSION.RECEIVE_SMS", 0 );
        put( "ANDROID.PERMISSION.VIBRATE", 0 );
        put( "ANDROID.PERMISSION.ACCESS_FINE_LOCATION", 0 );
        put( "ANDROID.PERMISSION.RECEIVE_BOOT_COMPLETED", 0 );
        put( "ANDROID.PERMISSION.SEND_SMS", 0 );
        put( "ANDROID.PERMISSION.ACCESS_COARSE_LOCATION", 0 );
        put( "ANDROID.PERMISSION.WAKE_LOCK", 0 );
        put( "ANDROID.PERMISSION.ACCESS_WIFI_STATE", 0 );
        put( "ANDROID.PERMISSION.WRITE_EXTERNAL_STORAGE", 0 );
        put( "ANDROID.PERMISSION.READ_PHONE_STATE", 0 );
        put( "ANDROID.PERMISSION.ACCESS_NETWORK_STATE", 0 );
        put( "ANDROID.PERMISSION.INTERNET", 0 );






    }};

    public static int isMalware = 0;

    public void add(String key){
        if(hm.containsKey(key)){
            hm.put(key, 1);
        }
    }

    public void writeHeading(){

        File tempFile = new File(filePath);
        boolean exists = tempFile.exists();
        if(exists)
            return;
        try
        {
            FileWriter fw = new FileWriter(filePath,true); //the true will append the new data
            for (Map.Entry<String, Integer> entry :
                    hm.entrySet()) {
                fw.write(entry.getKey()+",");
            }
            fw.write("isMalware, ");
            fw.write("\n");
            fw.close();
        }
        catch(IOException ioe)
        {
            System.err.println("IOException: " + ioe.getMessage());
        }
    }
    public void writeToFile(){

        try
        {
            FileWriter fw = new FileWriter(filePath,true); //the true will append the new data
            for (Map.Entry<String, Integer> entry :
                    hm.entrySet()) {
                fw.write(entry.getValue()+", ");
            }
            fw.write(isMalware+",");
            fw.write("\n");
            fw.close();
        }
        catch(IOException ioe)
        {
            System.err.println("IOException: " + ioe.getMessage());
        }
    }

}




